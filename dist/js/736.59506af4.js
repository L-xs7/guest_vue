(self["webpackChunkguest"]=self["webpackChunkguest"]||[]).push([[736],{2736:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"MenuContainer"},[n("div",{staticClass:"top_operation"},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium",placeholder:"请输入菜单名",clearable:""},on:{clear:e.getMenuTree},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getMenuTreeByName.apply(null,arguments)}},model:{value:e.menuName,callback:function(t){e.menuName=t},expression:"menuName"}}),n("el-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"medium",type:"info"},on:{click:e.getMenuTreeByName}},[e._v(" 搜索 ")]),n("el-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"el-icon-plus",size:"medium",type:"primary"},on:{click:function(t){return e.insMenu()}}},[e._v(" 添加菜单 ")])],1),n("div",{staticClass:"table_div"},[n("el-table",{attrs:{data:e.menuTableData,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[n("el-table-column",{attrs:{prop:"name",label:"菜单名","min-width":"180"}}),n("el-table-column",{attrs:{prop:"url",label:"全路径","min-width":"180"}}),n("el-table-column",{attrs:{prop:"path",label:"前端路由",width:"180"}}),n("el-table-column",{attrs:{prop:"component",label:"组件名","min-width":"270"}}),n("el-table-column",{attrs:{prop:"level",label:"层级","min-width":"80"}}),n("el-table-column",{attrs:{prop:"position",label:"位置","min-width":"80"}}),n("el-table-column",{attrs:{prop:"menu",label:"是否菜单",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.menu?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"keepAlice",label:"是否缓存",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.metas.keepAlice?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"require",label:"是否认证",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.metas.require?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"metas.redirect",label:"重定向","min-width":"180"}}),n("el-table-column",{attrs:{prop:"metas.icon",label:"图标","min-width":"180"}}),n("el-table-column",{attrs:{label:"创建日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(t.row.createDate).format("YYYY/MM/DD h:mm:ss"))+" ")]}}])}),n("el-table-column",{attrs:{label:"编辑",width:"85",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.inlineInsertMenu(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"insert","class-name":"insert"}})],1),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.deleteMenu(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"delete","class-name":"delete"}})],1),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.updateMenu(t.row)}}},[n("svg-icon",{attrs:{"icon-class":"update","class-name":"update"}})],1)]}}])})],1)],1),n("InsMenuDialog",{attrs:{menuDialogVisible:e.menuDialogVisible,title:e.title,menuCascaderData:e.menuCascaderData,defaultParentId:e.defaultParentId},on:{"update:menuDialogVisible":function(t){e.menuDialogVisible=t},"update:menu-dialog-visible":function(t){e.menuDialogVisible=t},getMenuTree:e.getMenuTree,"update:defaultParentId":function(t){e.defaultParentId=t},"update:default-parent-id":function(t){e.defaultParentId=t}}})],1)},i=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticStyle:{"margin-top":"-10vh"},attrs:{title:e.title,visible:e.menuDialogVisible,width:"680px","before-close":e.menuHandleClose,"append-to-body":""},on:{open:e.menuDialogOpen}},[n("el-form",{ref:"menuRuleFormRef",attrs:{model:e.menu,rules:e.menuFormRules,"label-width":"95px"}},[n("el-form-item",{attrs:{label:"菜单名称:",prop:"name"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.name,callback:function(t){e.$set(e.menu,"name",t)},expression:"menu.name"}})],1),n("el-form-item",{attrs:{label:"上级菜单:",prop:"parentId"}},[n("el-cascader",{staticStyle:{width:"216px"},attrs:{disabled:e.topMenu,size:"medium",options:e.menuCascaderData,props:e.cascaderProps},model:{value:e.menu.parentId,callback:function(t){e.$set(e.menu,"parentId",t)},expression:"menu.parentId"}}),n("el-checkbox",{staticStyle:{"margin-left":"12px"},on:{change:e.topMenuCheckBoxChange},model:{value:e.topMenu,callback:function(t){e.topMenu=t},expression:"topMenu"}},[e._v("是否顶级")])],1),n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"url:",prop:"url"}},[n("el-input",{staticStyle:{width:"128px"},attrs:{size:"medium"},model:{value:e.menu.url,callback:function(t){e.$set(e.menu,"url",t)},expression:"menu.url"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"path:",prop:"path"}},[n("el-input",{staticStyle:{width:"128px"},attrs:{size:"medium"},model:{value:e.menu.path,callback:function(t){e.$set(e.menu,"path",t)},expression:"menu.path"}})],1)],1)],1),n("el-form-item",{attrs:{label:"component:"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.component,callback:function(t){e.$set(e.menu,"component",t)},expression:"menu.component"}})],1),n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"层级:",prop:"level"}},[n("el-input-number",{staticStyle:{width:"80px"},attrs:{size:"medium",controls:!1},model:{value:e.menu.level,callback:function(t){e.$set(e.menu,"level",t)},expression:"menu.level"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"位置:",prop:"position"}},[n("el-input-number",{staticStyle:{width:"80px"},attrs:{size:"medium",controls:!1},model:{value:e.menu.position,callback:function(t){e.$set(e.menu,"position",t)},expression:"menu.position"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否菜单:"}},[n("el-checkbox",{model:{value:e.menu.menu,callback:function(t){e.$set(e.menu,"menu",t)},expression:"menu.menu"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否缓存:"}},[n("el-checkbox",{model:{value:e.menu.metas.keepAlice,callback:function(t){e.$set(e.menu.metas,"keepAlice",t)},expression:"menu.metas.keepAlice"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否认证:"}},[n("el-checkbox",{model:{value:e.menu.metas.requeire,callback:function(t){e.$set(e.menu.metas,"requeire",t)},expression:"menu.metas.requeire"}})],1)],1)],1),n("el-form-item",{attrs:{label:"重定向:"}},[n("el-select",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.metas.redirect,callback:function(t){e.$set(e.menu.metas,"redirect",t)},expression:"menu.metas.redirect"}},e._l(e.redirectSelectData,(function(e){return n("el-option",{key:e.id,attrs:{value:e.url+" ("+e.name+")"}})})),1)],1),n("el-form-item",{attrs:{label:"图标:"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.metas.icon,callback:function(t){e.$set(e.menu.metas,"icon",t)},expression:"menu.metas.icon"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:e.menuHandleClose}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.insMenu}},[e._v("确 定")])],1)],1)},l=[],s=n(8937),u=n.n(s),o={name:"InsMenuDialog",data(){return{menu:{id:null,name:"",parentId:0,url:"",path:"",component:"",level:void 0,position:void 0,menu:!1,hidden:!1,metas:{icon:"",keepAlice:!1,redirect:"",require:!1}},menuFormRules:{name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],parentId:[{required:!0,message:"请选择上级菜单",trigger:"change"}],url:[{required:!0,message:"请输入url",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],level:[{required:!0,message:"请输入菜单层级",trigger:"blur"}],position:[{required:!0,message:"请输入菜单位置",trigger:"blur"}]},cascaderProps:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},topMenu:!1,redirectSelectData:[],tempParentId:void 0}},props:{menuDialogVisible:{type:Boolean,default:!1},title:{type:String},menuCascaderData:{type:Array},defaultParentId:{type:Number,default:0},saveOrUpdate:{type:Number,default:0}},methods:{menuDialogOpen(){this.menu.parentId=this.defaultParentId,this.getListMenu()},async getListMenu(){const e=await this.getRequest("/menu/selMenuList");this.redirectSelectData=e.data},menuHandleClose(){this.menu={id:null,name:"",parentId:0,url:"",path:"",component:"",level:void 0,position:void 0,menu:!1,hidden:!1,metas:{icon:"",keepAlice:!1,redirect:"",require:!1}},this.topMenu=!1,this.$refs["menuRuleFormRef"].resetFields(),this.$emit("update:menuDialogVisible",!1),this.$emit("update:defaultParentId",0)},insMenu(){this.$refs["menuRuleFormRef"].validate((async e=>{if(!e)return;const t=await this.postRequest("/menu/operationMenu",this.menu);200===t.status&&(this.$message.success("新建菜单成功"),this.menuHandleClose(),this.$emit("getMenuTree"))}))},updateMenu(e){console.log(e),this.menu={id:e.id,name:e.name,parentId:e.parentId,url:e.url,path:e.path,component:e.component,level:e.level,position:e.position,menu:e.menu,hidden:e.hidden,metas:{icon:e.metas.icon,keepAlice:e.metas.keepAlice,redirect:e.metas.redirect,require:e.metas.require}},0===this.menu.parentId&&(this.topMenu=!0)},topMenuCheckBoxChange(e){e?(this.tempParentId=this.menu.parentId,this.menu.parentId=0,this.menu.level=0):this.menu.parentId=this.tempParentId}},watch:{"menu.parentId":{async handler(e){if(!e||void 0===e)return;const t=await this.getRequest("/menu/selMenuById?id="+e);this.menu.level=t.data.selMenuById.level+1}}},mounted(){this.menuPubSub=u().subscribe("update",((e,t)=>{this.updateMenu(t)}))},beforeDestroy(){u().unsubscribe(this.menuPubSub)}},c=o,m=n(1001),p=(0,m.Z)(c,r,l,!1,null,null,null),d=p.exports,f={name:"MenuContainer",data(){return{menuTableData:[],menuCascaderData:[],menuDialogVisible:!1,title:"",menuName:"",defaultParentId:0}},components:{InsMenuDialog:d},methods:{async getMenuTree(){const e=await this.getRequest("/menu/selMenuTree");this.menuTableData=e.data,this.menuCascaderData=e.data},async getMenuTreeByName(){const e=await this.getRequest(`/menu/selMenuByName?menuName=${this.menuName}`);let t=[];e.data&&e.data[0].length>0&&(e.data[0].forEach((e=>{t.push(e)})),this.menuTableData=t)},insMenu(){this.title="新建菜单",this.menuDialogVisible=!0},inlineInsertMenu(e){this.title="新建菜单",this.defaultParentId=e.id,this.menuDialogVisible=!0},async deleteMenu(e){const t=await this.$messageBox.confirm("此操作会删除该菜单信息，是否继续","确认删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消删除");const n=await this.getRequest(`/menu/delMenu?id=${e.id}`).catch((e=>e));200===n.status&&(this.$message.success(`已成功删除【${e.name}】菜单`),this.getMenuTree())},updateMenu(e){u().publish("update",e),this.title="编辑菜单",this.menuDialogVisible=!0}},mounted(){this.getMenuTree()}},b=f,h=(0,m.Z)(b,a,i,!1,null,"1679fa07",null),y=h.exports},8937:function(e,t,n){e=n.nmd(e),function(n,a){"use strict";var i={};n.PubSub?(i=n.PubSub,console.warn("PubSub already loaded, using existing version")):(n.PubSub=i,a(i)),void 0!==e&&e.exports&&(t=e.exports=i),t.PubSub=i,e.exports=t=i}("object"===typeof window&&window||this,(function(e){"use strict";var t={},n=-1,a="*";function i(e){var t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}function r(e){return function(){throw e}}function l(e,t,n){try{e(t,n)}catch(a){setTimeout(r(a),0)}}function s(e,t,n){e(t,n)}function u(e,n,a,i){var r,u=t[n],o=i?s:l;if(Object.prototype.hasOwnProperty.call(t,n))for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&o(u[r],e,a)}function o(e,t,n){return function(){var i=String(e),r=i.lastIndexOf(".");u(e,e,t,n);while(-1!==r)i=i.substr(0,r),r=i.lastIndexOf("."),u(e,i,t,n);u(e,a,t,n)}}function c(e){var n=String(e),a=Boolean(Object.prototype.hasOwnProperty.call(t,n)&&i(t[n]));return a}function m(e){var t=String(e),n=c(t)||c(a),i=t.lastIndexOf(".");while(!n&&-1!==i)t=t.substr(0,i),i=t.lastIndexOf("."),n=c(t);return n}function p(e,t,n,a){e="symbol"===typeof e?e.toString():e;var i=o(e,t,a),r=m(e);return!!r&&(!0===n?i():setTimeout(i,0),!0)}e.publish=function(t,n){return p(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return p(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,a){if("function"!==typeof a)return!1;e="symbol"===typeof e?e.toString():e,Object.prototype.hasOwnProperty.call(t,e)||(t[e]={});var i="uid_"+String(++n);return t[e][i]=a,i},e.subscribeAll=function(t){return e.subscribe(a,t)},e.subscribeOnce=function(t,n){var a=e.subscribe(t,(function(){e.unsubscribe(a),n.apply(this,arguments)}));return e},e.clearAllSubscriptions=function(){t={}},e.clearSubscriptions=function(e){var n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&delete t[n]},e.countSubscriptions=function(e){var n,a,i=0;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)){for(a in t[n])i++;break}return i},e.getSubscriptions=function(e){var n,a=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&a.push(n);return a},e.unsubscribe=function(n){var a,i,r,l=function(e){var n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e))return!0;return!1},s="string"===typeof n&&(Object.prototype.hasOwnProperty.call(t,n)||l(n)),u=!s&&"string"===typeof n,o="function"===typeof n,c=!1;if(!s){for(a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(i=t[a],u&&i[n]){delete i[n],c=n;break}if(o)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&i[r]===n&&(delete i[r],c=!0)}return c}e.clearSubscriptions(n)}}))}}]);
//# sourceMappingURL=736.59506af4.js.map