(self["webpackChunkguest"]=self["webpackChunkguest"]||[]).push([[819],{5819:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return D}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"RegionConfig"},[i("div",{staticClass:"operating_top"},[i("el-input",{staticStyle:{width:"216px"},attrs:{clearable:"",size:"medium",placeholder:"输入省份名","suffix-icon":"el-icon-search"},on:{clear:t.getRegionList},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getRegionList.apply(null,arguments)}},model:{value:t.query.provinceName,callback:function(e){t.$set(t.query,"provinceName",e)},expression:"query.provinceName"}}),i("el-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"medium",type:"info"},on:{click:t.getRegionList}},[t._v(" 搜索 ")]),i("el-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"el-icon-plus",size:"medium",type:"primary"},on:{click:function(e){return t.saveProvince()}}},[t._v(" 添加省份 ")])],1),i("div",{staticClass:"data_medium"},[i("div",{staticClass:"left_list"},t._l(t.regionList,(function(e,s){return i("el-card",{key:e.id,class:{isActive:t.isActiveIndex===s},nativeOn:{"!click":function(i){return t.activeCard(e,s)},mouseenter:function(e){return t.cardMouseEnter(s)},mouseleave:function(e){return t.cardMouseLeave()}}},[i("div",{staticClass:"name"},[i("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"name"}}),t._v(" "+t._s(e.provinceName)+" "),i("el-switch",{attrs:{"active-color":"#5A97DB","inactive-color":"#000",width:35},nativeOn:{click:function(i){return t.regionStatusUpdate(e)}},model:{value:e.status,callback:function(i){t.$set(e,"status",i)},expression:"item.status"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:s===t.mouseEnterIndex,expression:"index === mouseEnterIndex"}],staticClass:"btn"},[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.insCitys(e)}}},[i("svg-icon",{attrs:{"icon-class":"insert","class-name":"insert"}})],1),i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.updateProvince(e)}}},[i("svg-icon",{attrs:{"icon-class":"update","class-name":"update"}})],1),i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.deleteProvince(e)}}},[i("svg-icon",{attrs:{"icon-class":"delete","class-name":"delete"}})],1)])],1),i("div",{staticClass:"bottom"},[i("div",{staticClass:"code"},[i("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"code"}}),t._v(" "+t._s(e.code)+" ")],1),i("div",{staticClass:"time"},[t._v(t._s(t.$moment(e.createDate).format("YYYY/MM/DD h:mm:ss")))])])])})),1),i("div",{staticClass:"tableContainer"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.table_date,"cell-style":t.changeCellStyle}},[i("el-table-column",{attrs:{label:"城市名","min-width":"130",prop:"cityName"}}),i("el-table-column",{attrs:{label:"城市编码","min-width":"130",prop:"code"}}),i("el-table-column",{attrs:{label:"新建时间","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(e.row.createDate).format("YYYY/MM/DD h:mm:ss"))+" ")]}}])}),i("el-table-column",{attrs:{label:"启用状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},nativeOn:{"!click":function(i){return t.updateCityStatus(e.row)}},model:{value:e.row.status,callback:function(i){t.$set(e.row,"status",i)},expression:"scope.row.status"}})]}}])}),i("el-table-column",{attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.deleteCity(e.row)}}},[i("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"delete","class-name":"delete"}})],1),i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.updateCity(e.row)}}},[i("svg-icon",{attrs:{"icon-class":"update","class-name":"update"}})],1)]}}])})],1)],1)]),i("InsRegionDialog",{attrs:{insRegionDialogVisible:t.insRegionDialogVisible,saveOrUpdate:t.saveOrUpdate,title:t.title},on:{"update:insRegionDialogVisible":function(e){t.insRegionDialogVisible=e},"update:ins-region-dialog-visible":function(e){t.insRegionDialogVisible=e},getRegionList:t.getRegionList}}),i("InsCityDialog",{attrs:{insCityDialogVisible:t.insCityDialogVisible,citySelect:t.citySelect,citySaveOrUpdate:t.citySaveOrUpdate,cityDialogTitle:t.cityDialogTitle},on:{"update:insCityDialogVisible":function(e){t.insCityDialogVisible=e},"update:ins-city-dialog-visible":function(e){t.insCityDialogVisible=e},getTableData:t.getTableData}})],1)},a=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,visible:t.insRegionDialogVisible,width:"30%","before-close":t.handleClose,"append-to-body":""},on:{close:t.provinceClosed}},[i("el-form",{ref:"form",attrs:{rules:t.rules,model:t.province,"label-width":"85px"}},[i("el-form-item",{attrs:{label:"省份名称:",prop:"provinceName"}},[i("el-select",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:t.province.provinceName,callback:function(e){t.$set(t.province,"provinceName",e)},expression:"province.provinceName"}},t._l(t.regions,(function(t){return i("el-option",{key:t.id,attrs:{value:t.district_name,label:t.district_name}})})),1)],1),i("el-form-item",{attrs:{label:"省份编码:",prop:"code"}},[i("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:t.province.code,callback:function(e){t.$set(t.province,"code",e)},expression:"province.code"}})],1),i("el-form-item",{attrs:{label:"启用:"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.province.status,callback:function(e){t.$set(t.province,"status",e)},expression:"province.status"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"medium",type:"info"},on:{click:function(e){return t.handleClose()}}},[t._v("取 消")]),i("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(e){return t.saveRegion()}}},[t._v("确 定")])],1)],1)},o=[],r=i(8937),c=i.n(r),l={name:"InsRegionDialog",data(){return{regions:[],province:{id:"",provinceName:"",code:"",status:!0},rules:{provinceName:[{required:!0,message:"请输入省份名称",trigger:"blur"}],code:[{required:!0,message:"请输入省份编码",trigger:"blur"}]}}},props:{insRegionDialogVisible:{type:Boolean,default:!1},saveOrUpdate:{type:Number},title:{type:String}},methods:{handleClose(){this.$emit("update:insRegionDialogVisible",!1)},provinceClosed(){this.province={id:"",provinceName:"",code:"",status:!0},this.$refs["form"].resetFields()},saveRegion(){this.$refs["form"].validate((async t=>{if(!t)return;const e=await this.postRequest(`/region/provinceau?operation=${this.saveOrUpdate}`,this.province);200===e.status&&(0===this.saveOrUpdate?this.$message.success("添加省份成功！"):1===this.saveOrUpdate?this.$message.success("修改省份成功！"):this.$message.error("操作符错误！"),this.handleClose(),this.$emit("getRegionList"))}))},updateRegion(t){this.province.id=t.id,this.province.provinceName=t.provinceName,this.province.code=t.code,this.province.status=t.status,this.province.createDate=t.createDate},async getAllRegion(){const t=await this.getRequest("/district/selRegion");this.regions=t.data}},mounted(){this.regionPubSub=c().subscribe("update",((t,e)=>{this.updateRegion(e)}))},created(){this.getAllRegion()},beforeDestroy(){c().unsubscribe(this.regionPubSub)}},u=l,d=i(1001),p=(0,d.Z)(u,n,o,!1,null,"0a7e9d90",null),g=p.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.cityDialogTitle,visible:t.insCityDialogVisible,width:"30%","before-close":t.handleClose,"append-to-body":""},on:{close:t.citysDialogClosed}},[i("el-form",{ref:"form",attrs:{rules:t.rules,model:t.citys,"label-width":"85px"}},[i("el-form-item",{attrs:{label:"城市名称:",prop:"cityName"}},[i("el-select",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:t.citys.cityName,callback:function(e){t.$set(t.citys,"cityName",e)},expression:"citys.cityName"}},t._l(t.citySelect,(function(t){return i("el-option",{key:t.id,attrs:{value:t.district_name,label:t.district_name}})})),1)],1),i("el-form-item",{attrs:{label:"城市编码:",prop:"code"}},[i("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:t.citys.code,callback:function(e){t.$set(t.citys,"code",e)},expression:"citys.code"}})],1),i("el-form-item",{attrs:{label:"启用:"}},[i("el-switch",{model:{value:t.citys.status,callback:function(e){t.$set(t.citys,"status",e)},expression:"citys.status"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"medium",type:"info"},on:{click:t.handleClose}},[t._v("取 消")]),i("el-button",{attrs:{size:"medium",type:"success"},on:{click:t.saveCity}},[t._v("确 定")])],1)],1)},m=[],f={name:"InsCityDialog",data(){return{citys:{id:"",cityName:"",code:"",provinceId:"",status:!0},rules:{cityName:[{required:!0,message:"请选择城市名称",trigger:"change"}],code:[{required:!0,message:"请输入城市编码",trigger:"blur"}]}}},props:{insCityDialogVisible:{type:Boolean,default:!1},citySaveOrUpdate:{type:Number},cityDialogTitle:{type:String},citySelect:{type:Array}},methods:{handleClose(){this.$emit("update:insCityDialogVisible",!1)},citysDialogClosed(){this.citys={id:"",cityName:"",code:"",provinceId:"",status:!0},this.$refs["form"].resetFields()},saveCity(){this.$refs["form"].validate((async t=>{if(!t)return;const e=window.sessionStorage.getItem("activeRegion");this.citys.provinceId=e;const i=await this.postRequest("/ciyts/citysau?operation="+this.citySaveOrUpdate,this.citys);200===i.status&&(0===this.citySaveOrUpdate?this.$message.success("添加城市成功！"):1===this.citySaveOrUpdate&&this.$message.success("编辑城市成功！"),this.handleClose(),this.$emit("getTableData",e))}))},updateCity(t){this.citys={id:t.id,cityName:t.cityName,code:t.code,provinceId:t.provinceId,status:t.status}}},mounted(){this.cityId=c().subscribe("update",((t,e)=>{this.updateCity(e)}))},beforeDestroy(){c().unsubscribe(this.cityId)}},h=f,v=(0,d.Z)(h,y,m,!1,null,"a5a9c49e",null),b=v.exports,w={name:"RegionConfig",components:{InsRegionDialog:g,InsCityDialog:b},data(){return{insRegionDialogVisible:!1,title:"",insCityDialogVisible:!1,cityDialogTitle:"",regionList:[],citySelect:[],query:{provinceName:""},isActiveIndex:0,mouseEnterIndex:null,saveOrUpdate:null,citySaveOrUpdate:null,table_date:[]}},methods:{changeCellStyle(t){if("操作"===t.column.label)return"display:flex;"},async getRegionList(){const t=await this.getRequest("/region/selAll",this.query);this.regionList=t.data.query_province,this.regionList.length>0&&this.getTableData(this.regionList[0].id)},async deleteProvince(t){const e=await this.$messageBox.confirm("此操作会删除该省份信息，是否继续","确认删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{this.$message.info("已取消删除！")}));if("confirm"!==e)return;const i=await this.getRequest("/region/operationdu",{operation:0,id:t.id});200===i.status&&(this.$message.success(`删除[${t.provinceName}]省份信息成功！`),this.getRegionList())},async regionStatusUpdate(t){const e=await this.$messageBox.confirm("此操作会修改该省份的启用状态，是否继续","确认？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{t.status=!t.status,this.$message.info("已取消操作！")}));if("confirm"!==e)return;const i=await this.getRequest("/region/operationdu",{operation:1,id:t.id});200===i.status&&(this.$message.success(`修改[${t.provinceName}]省份状态成功！`),this.getRegionList())},saveProvince(){this.saveOrUpdate=0,this.title="新增省份信息",this.insRegionDialogVisible=!0},updateProvince(t){this.saveOrUpdate=1,this.title="编辑省份信息",this.insRegionDialogVisible=!0,c().publish("update",t)},activeCard(t,e){window.sessionStorage.setItem("activeRegion",t.id),this.isActiveIndex=e,this.getTableData(t.id)},cardMouseEnter(t){this.mouseEnterIndex=t},cardMouseLeave(){this.mouseEnterIndex=null},insCitys(t){this.cityDialogTitle="新增城市信息",this.citySaveOrUpdate=0,this.listCitysByDistrict(t.provinceName),this.insCityDialogVisible=!0},async listCitysByDistrict(t){const e=await this.getRequest(`/district/selByName?provinceName=${t}`);this.citySelect=e.data},async getTableData(t){const e=await this.getRequest(`/ciyts/selByPIdD?regionId=${t}`);this.table_date=e.data},async deleteCity(t){const e=await this.$messageBox.confirm("此操作会删除该城市信息，是否继续","确认删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{this.$message.info("已取消删除！")}));if("confirm"!==e)return;const i=await this.getRequest("/ciyts/citysdu",{operation:"0",cityId:t.id});200===i.status&&(this.$message({type:"success",message:"删除城市信息成功！",duration:0}),this.getTableData(t.provinceId))},updateCity(t){this.cityDialogTitle="编辑城市信息",this.citySaveOrUpdate=1,this.listCitysByDistrict(t.province.provinceName),this.insCityDialogVisible=!0,c().publish("update",t)},async updateCityStatus(t){const e=await this.$messageBox.confirm("此操作会修改该城市的启用状态，是否继续","确认？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{t.status=!t.status,this.$message.info("已取消操作！")}));if("confirm"!==e)return;const i=await this.getRequest("/ciyts/citysdu",{operation:"1",cityId:t.id});200===i.status&&(this.$message.success(`修改[${t.cityName}]城市状态成功！`),this.getRegionList())}},created(){this.getRegionList()},mounted(){}},x=w,C=(0,d.Z)(x,s,a,!1,null,"53c33897",null),D=C.exports},8937:function(t,e,i){t=i.nmd(t),function(i,s){"use strict";var a={};i.PubSub?(a=i.PubSub,console.warn("PubSub already loaded, using existing version")):(i.PubSub=a,s(a)),void 0!==t&&t.exports&&(e=t.exports=a),e.PubSub=a,t.exports=e=a}("object"===typeof window&&window||this,(function(t){"use strict";var e={},i=-1,s="*";function a(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}function n(t){return function(){throw t}}function o(t,e,i){try{t(e,i)}catch(s){setTimeout(n(s),0)}}function r(t,e,i){t(e,i)}function c(t,i,s,a){var n,c=e[i],l=a?r:o;if(Object.prototype.hasOwnProperty.call(e,i))for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&l(c[n],t,s)}function l(t,e,i){return function(){var a=String(t),n=a.lastIndexOf(".");c(t,t,e,i);while(-1!==n)a=a.substr(0,n),n=a.lastIndexOf("."),c(t,a,e,i);c(t,s,e,i)}}function u(t){var i=String(t),s=Boolean(Object.prototype.hasOwnProperty.call(e,i)&&a(e[i]));return s}function d(t){var e=String(t),i=u(e)||u(s),a=e.lastIndexOf(".");while(!i&&-1!==a)e=e.substr(0,a),a=e.lastIndexOf("."),i=u(e);return i}function p(t,e,i,s){t="symbol"===typeof t?t.toString():t;var a=l(t,e,s),n=d(t);return!!n&&(!0===i?a():setTimeout(a,0),!0)}t.publish=function(e,i){return p(e,i,!1,t.immediateExceptions)},t.publishSync=function(e,i){return p(e,i,!0,t.immediateExceptions)},t.subscribe=function(t,s){if("function"!==typeof s)return!1;t="symbol"===typeof t?t.toString():t,Object.prototype.hasOwnProperty.call(e,t)||(e[t]={});var a="uid_"+String(++i);return e[t][a]=s,a},t.subscribeAll=function(e){return t.subscribe(s,e)},t.subscribeOnce=function(e,i){var s=t.subscribe(e,(function(){t.unsubscribe(s),i.apply(this,arguments)}));return t},t.clearAllSubscriptions=function(){e={}},t.clearSubscriptions=function(t){var i;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&0===i.indexOf(t)&&delete e[i]},t.countSubscriptions=function(t){var i,s,a=0;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&0===i.indexOf(t)){for(s in e[i])a++;break}return a},t.getSubscriptions=function(t){var i,s=[];for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&0===i.indexOf(t)&&s.push(i);return s},t.unsubscribe=function(i){var s,a,n,o=function(t){var i;for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&0===i.indexOf(t))return!0;return!1},r="string"===typeof i&&(Object.prototype.hasOwnProperty.call(e,i)||o(i)),c=!r&&"string"===typeof i,l="function"===typeof i,u=!1;if(!r){for(s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(a=e[s],c&&a[i]){delete a[i],u=i;break}if(l)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&a[n]===i&&(delete a[n],u=!0)}return u}t.clearSubscriptions(i)}}))}}]);
//# sourceMappingURL=819.0acb0667.js.map