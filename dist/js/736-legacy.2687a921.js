(self["webpackChunkguest"]=self["webpackChunkguest"]||[]).push([[736],{2736:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"MenuContainer"},[n("div",{staticClass:"top_operation"},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium",placeholder:"请输入菜单名",clearable:""},on:{clear:e.getMenuTree},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getMenuTreeByName.apply(null,arguments)}},model:{value:e.menuName,callback:function(t){e.menuName=t},expression:"menuName"}}),n("el-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"medium",type:"info"},on:{click:e.getMenuTreeByName}},[e._v(" 搜索 ")]),n("el-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"el-icon-plus",size:"medium",type:"primary"},on:{click:function(t){return e.insMenu()}}},[e._v(" 添加菜单 ")])],1),n("div",{staticClass:"table_div"},[n("el-table",{attrs:{data:e.menuTableData,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[n("el-table-column",{attrs:{prop:"name",label:"菜单名","min-width":"180"}}),n("el-table-column",{attrs:{prop:"url",label:"全路径","min-width":"180"}}),n("el-table-column",{attrs:{prop:"path",label:"前端路由",width:"180"}}),n("el-table-column",{attrs:{prop:"component",label:"组件名","min-width":"270"}}),n("el-table-column",{attrs:{prop:"level",label:"层级","min-width":"80"}}),n("el-table-column",{attrs:{prop:"position",label:"位置","min-width":"80"}}),n("el-table-column",{attrs:{prop:"menu",label:"是否菜单",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.menu?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"keepAlice",label:"是否缓存",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.metas.keepAlice?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"require",label:"是否认证",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.metas.require?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{prop:"metas.redirect",label:"重定向","min-width":"180"}}),n("el-table-column",{attrs:{prop:"metas.icon",label:"图标","min-width":"180"}}),n("el-table-column",{attrs:{label:"创建日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(t.row.createDate).format("YYYY/MM/DD h:mm:ss"))+" ")]}}])}),n("el-table-column",{attrs:{label:"编辑",width:"85",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.inlineInsertMenu(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"insert","class-name":"insert"}})],1),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.deleteMenu(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{"icon-class":"delete","class-name":"delete"}})],1),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.updateMenu(t.row)}}},[n("svg-icon",{attrs:{"icon-class":"update","class-name":"update"}})],1)]}}])})],1)],1),n("InsMenuDialog",{attrs:{menuDialogVisible:e.menuDialogVisible,title:e.title,menuCascaderData:e.menuCascaderData,defaultParentId:e.defaultParentId},on:{"update:menuDialogVisible":function(t){e.menuDialogVisible=t},"update:menu-dialog-visible":function(t){e.menuDialogVisible=t},getMenuTree:e.getMenuTree,"update:defaultParentId":function(t){e.defaultParentId=t},"update:default-parent-id":function(t){e.defaultParentId=t}}})],1)},a=[],i=n(16198),u=(n(41539),n(54747),n(68309),n(78975),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticStyle:{"margin-top":"-10vh"},attrs:{title:e.title,visible:e.menuDialogVisible,width:"680px","before-close":e.menuHandleClose,"append-to-body":""},on:{open:e.menuDialogOpen}},[n("el-form",{ref:"menuRuleFormRef",attrs:{model:e.menu,rules:e.menuFormRules,"label-width":"95px"}},[n("el-form-item",{attrs:{label:"菜单名称:",prop:"name"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.name,callback:function(t){e.$set(e.menu,"name",t)},expression:"menu.name"}})],1),n("el-form-item",{attrs:{label:"上级菜单:",prop:"parentId"}},[n("el-cascader",{staticStyle:{width:"216px"},attrs:{disabled:e.topMenu,size:"medium",options:e.menuCascaderData,props:e.cascaderProps},model:{value:e.menu.parentId,callback:function(t){e.$set(e.menu,"parentId",t)},expression:"menu.parentId"}}),n("el-checkbox",{staticStyle:{"margin-left":"12px"},on:{change:e.topMenuCheckBoxChange},model:{value:e.topMenu,callback:function(t){e.topMenu=t},expression:"topMenu"}},[e._v("是否顶级")])],1),n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"url:",prop:"url"}},[n("el-input",{staticStyle:{width:"128px"},attrs:{size:"medium"},model:{value:e.menu.url,callback:function(t){e.$set(e.menu,"url",t)},expression:"menu.url"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"path:",prop:"path"}},[n("el-input",{staticStyle:{width:"128px"},attrs:{size:"medium"},model:{value:e.menu.path,callback:function(t){e.$set(e.menu,"path",t)},expression:"menu.path"}})],1)],1)],1),n("el-form-item",{attrs:{label:"component:"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.component,callback:function(t){e.$set(e.menu,"component",t)},expression:"menu.component"}})],1),n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"层级:",prop:"level"}},[n("el-input-number",{staticStyle:{width:"80px"},attrs:{size:"medium",controls:!1},model:{value:e.menu.level,callback:function(t){e.$set(e.menu,"level",t)},expression:"menu.level"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"位置:",prop:"position"}},[n("el-input-number",{staticStyle:{width:"80px"},attrs:{size:"medium",controls:!1},model:{value:e.menu.position,callback:function(t){e.$set(e.menu,"position",t)},expression:"menu.position"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否菜单:"}},[n("el-checkbox",{model:{value:e.menu.menu,callback:function(t){e.$set(e.menu,"menu",t)},expression:"menu.menu"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否缓存:"}},[n("el-checkbox",{model:{value:e.menu.metas.keepAlice,callback:function(t){e.$set(e.menu.metas,"keepAlice",t)},expression:"menu.metas.keepAlice"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否认证:"}},[n("el-checkbox",{model:{value:e.menu.metas.requeire,callback:function(t){e.$set(e.menu.metas,"requeire",t)},expression:"menu.metas.requeire"}})],1)],1)],1),n("el-form-item",{attrs:{label:"重定向:"}},[n("el-select",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.metas.redirect,callback:function(t){e.$set(e.menu.metas,"redirect",t)},expression:"menu.metas.redirect"}},e._l(e.redirectSelectData,(function(e){return n("el-option",{key:e.id,attrs:{value:e.url+" ("+e.name+")"}})})),1)],1),n("el-form-item",{attrs:{label:"图标:"}},[n("el-input",{staticStyle:{width:"216px"},attrs:{size:"medium"},model:{value:e.menu.metas.icon,callback:function(t){e.$set(e.menu.metas,"icon",t)},expression:"menu.metas.icon"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:e.menuHandleClose}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.insMenu}},[e._v("确 定")])],1)],1)}),l=[],s=(n(9653),n(88937)),o=n.n(s),c={name:"InsMenuDialog",data:function(){return{menu:{id:null,name:"",parentId:0,url:"",path:"",component:"",level:void 0,position:void 0,menu:!1,hidden:!1,metas:{icon:"",keepAlice:!1,redirect:"",require:!1}},menuFormRules:{name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],parentId:[{required:!0,message:"请选择上级菜单",trigger:"change"}],url:[{required:!0,message:"请输入url",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],level:[{required:!0,message:"请输入菜单层级",trigger:"blur"}],position:[{required:!0,message:"请输入菜单位置",trigger:"blur"}]},cascaderProps:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},topMenu:!1,redirectSelectData:[],tempParentId:void 0}},props:{menuDialogVisible:{type:Boolean,default:!1},title:{type:String},menuCascaderData:{type:Array},defaultParentId:{type:Number,default:0},saveOrUpdate:{type:Number,default:0}},methods:{menuDialogOpen:function(){this.menu.parentId=this.defaultParentId,this.getListMenu()},getListMenu:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/menu/selMenuList");case 2:n=t.sent,e.redirectSelectData=n.data;case 4:case"end":return t.stop()}}),t)})))()},menuHandleClose:function(){this.menu={id:null,name:"",parentId:0,url:"",path:"",component:"",level:void 0,position:void 0,menu:!1,hidden:!1,metas:{icon:"",keepAlice:!1,redirect:"",require:!1}},this.topMenu=!1,this.$refs["menuRuleFormRef"].resetFields(),this.$emit("update:menuDialogVisible",!1),this.$emit("update:defaultParentId",0)},insMenu:function(){var e=this;this.$refs["menuRuleFormRef"].validate(function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.postRequest("/menu/operationMenu",e.menu);case 4:r=t.sent,200===r.status&&(e.$message.success("新建菜单成功"),e.menuHandleClose(),e.$emit("getMenuTree"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},updateMenu:function(e){console.log(e),this.menu={id:e.id,name:e.name,parentId:e.parentId,url:e.url,path:e.path,component:e.component,level:e.level,position:e.position,menu:e.menu,hidden:e.hidden,metas:{icon:e.metas.icon,keepAlice:e.metas.keepAlice,redirect:e.metas.redirect,require:e.metas.require}},0===this.menu.parentId&&(this.topMenu=!0)},topMenuCheckBoxChange:function(e){e?(this.tempParentId=this.menu.parentId,this.menu.parentId=0,this.menu.level=0):this.menu.parentId=this.tempParentId}},watch:{"menu.parentId":{handler:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e&&void 0!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getRequest("/menu/selMenuById?id="+e);case 4:r=n.sent,t.menu.level=r.data.selMenuById.level+1;case 6:case"end":return n.stop()}}),n)})))()}}},mounted:function(){var e=this;this.menuPubSub=o().subscribe("update",(function(t,n){e.updateMenu(n)}))},beforeDestroy:function(){o().unsubscribe(this.menuPubSub)}},m=c,p=n(1001),d=(0,p.Z)(m,u,l,!1,null,null,null),f=d.exports,b={name:"MenuContainer",data:function(){return{menuTableData:[],menuCascaderData:[],menuDialogVisible:!1,title:"",menuName:"",defaultParentId:0}},components:{InsMenuDialog:f},methods:{getMenuTree:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/menu/selMenuTree");case 2:n=t.sent,e.menuTableData=n.data,e.menuCascaderData=n.data;case 5:case"end":return t.stop()}}),t)})))()},getMenuTreeByName:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/menu/selMenuByName?menuName=".concat(e.menuName));case 2:n=t.sent,r=[],n.data&&n.data[0].length>0&&(n.data[0].forEach((function(e){r.push(e)})),e.menuTableData=r);case 5:case"end":return t.stop()}}),t)})))()},insMenu:function(){this.title="新建菜单",this.menuDialogVisible=!0},inlineInsertMenu:function(e){this.title="新建菜单",this.defaultParentId=e.id,this.menuDialogVisible=!0},deleteMenu:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$messageBox.confirm("此操作会删除该菜单信息，是否继续","确认删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=n.sent,"confirm"===r){n.next=5;break}return n.abrupt("return",t.$message.info("已取消删除"));case 5:return n.next=7,t.getRequest("/menu/delMenu?id=".concat(e.id)).catch((function(e){return e}));case 7:a=n.sent,200===a.status&&(t.$message.success("已成功删除【".concat(e.name,"】菜单")),t.getMenuTree());case 9:case"end":return n.stop()}}),n)})))()},updateMenu:function(e){o().publish("update",e),this.title="编辑菜单",this.menuDialogVisible=!0}},mounted:function(){this.getMenuTree()}},h=b,v=(0,p.Z)(h,r,a,!1,null,"1679fa07",null),g=v.exports},88937:function(e,t,n){var r;e=n.nmd(e);var a=n(17964)["default"];n(41539),n(39714),function(i,u){"use strict";var l={};i.PubSub?(l=i.PubSub,console.warn("PubSub already loaded, using existing version")):(i.PubSub=l,u(l)),"object"===a(t)?(void 0!==e&&e.exports&&(t=e.exports=l),t.PubSub=l,e.exports=t=l):(r=function(){return l}.call(t,n,t,e),void 0===r||(e.exports=r))}("object"===("undefined"===typeof window?"undefined":a(window))&&window||this,(function(e){"use strict";var t={},n=-1,r="*";function i(e){var t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}function u(e){return function(){throw e}}function l(e,t,n){try{e(t,n)}catch(r){setTimeout(u(r),0)}}function s(e,t,n){e(t,n)}function o(e,n,r,a){var i,u=t[n],o=a?s:l;if(Object.prototype.hasOwnProperty.call(t,n))for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&o(u[i],e,r)}function c(e,t,n){return function(){var a=String(e),i=a.lastIndexOf(".");o(e,e,t,n);while(-1!==i)a=a.substr(0,i),i=a.lastIndexOf("."),o(e,a,t,n);o(e,r,t,n)}}function m(e){var n=String(e),r=Boolean(Object.prototype.hasOwnProperty.call(t,n)&&i(t[n]));return r}function p(e){var t=String(e),n=m(t)||m(r),a=t.lastIndexOf(".");while(!n&&-1!==a)t=t.substr(0,a),a=t.lastIndexOf("."),n=m(t);return n}function d(e,t,n,r){e="symbol"===a(e)?e.toString():e;var i=c(e,t,r),u=p(e);return!!u&&(!0===n?i():setTimeout(i,0),!0)}e.publish=function(t,n){return d(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return d(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,r){if("function"!==typeof r)return!1;e="symbol"===a(e)?e.toString():e,Object.prototype.hasOwnProperty.call(t,e)||(t[e]={});var i="uid_"+String(++n);return t[e][i]=r,i},e.subscribeAll=function(t){return e.subscribe(r,t)},e.subscribeOnce=function(t,n){var r=e.subscribe(t,(function(){e.unsubscribe(r),n.apply(this,arguments)}));return e},e.clearAllSubscriptions=function(){t={}},e.clearSubscriptions=function(e){var n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&delete t[n]},e.countSubscriptions=function(e){var n,r,a=0;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)){for(r in t[n])a++;break}return a},e.getSubscriptions=function(e){var n,r=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&r.push(n);return r},e.unsubscribe=function(n){var r,a,i,u=function(e){var n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e))return!0;return!1},l="string"===typeof n&&(Object.prototype.hasOwnProperty.call(t,n)||u(n)),s=!l&&"string"===typeof n,o="function"===typeof n,c=!1;if(!l){for(r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(a=t[r],s&&a[n]){delete a[n],c=n;break}if(o)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&a[i]===n&&(delete a[i],c=!0)}return c}e.clearSubscriptions(n)}}))}}]);
//# sourceMappingURL=736-legacy.2687a921.js.map